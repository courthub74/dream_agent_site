<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dream Agent ‚Äî Collections</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    /* :root { --da-blue:#0B5DB3; } */
    :root {
      width: 100%;
      color: white;
      background:
        linear-gradient(rgba(11, 93, 179, 0.5), rgba(11, 93, 179, 0.4)),
        url('./img/even_larger_about_background.png') center/cover no-repeat;
        }
        body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; }
        .serif { font-family: "Playfair Display", Georgia, serif; }
        h1, h2, h3, h4 {font-family: 'Playfair Display';}
        /* hide scrollbars for the mobile strip */
        .no-scrollbar::-webkit-scrollbar{ display:none; } .no-scrollbar{ -ms-overflow-style:none; scrollbar-width:none; }
  </style>
</head>
<body class="min-h-screen bg-[color:var(--da-blue)] text-white/95 selection:bg-white/20">

  <!-- =============== DATA =============== -->
  <script>
      // Example data. Swap this for a fetch('/api/collections/...') if you prefer.
      const COLLECTIONS = [
      {
        slug: "symbols-in-motion",
        title: "Symbols In Motion",
        subtitle: "Recurring signs in perpetual drift",
        startYear: 2017,
        endYear: 2025,
        works: [
          {
            slug: "some-things-were-meant",
            title: "Some Things were meant to last Forever",
            year: 2024,
            style: "Oil-style",
            motifs: ["cathedrals", "oven", "surreal"],
            image: "./pictures/some_things_were_meant.png", 
            thumb: "./pictures/some_things_were_meant.png",
            description: [
              "This surreal composition by Dream Agent presents an oven labeled Prosperity as an altar of permanence, where iconic cathedrals and basilicas from around the world rise like delicacies atopsilver cake stands. Each structure ‚Äî intricate, fragile, historic ‚Äî floats in a domestic kitchen space,blurring the line between the sacred and the mundane In this world, spiritual and cultural grandeur is both preserved and 'baked in'"
            ],
            marketplaces: {
              xrpCafe: "https://xrpcafe.market/‚Ä¶",
              openSea: "https://opensea.io/‚Ä¶",
              superRare: "https://superrare.com/‚Ä¶"
            }
          },
          {
            slug: "the-great-divide",
            title: "The Great Divide",
            year: 2021, style: "Oil-style", motifs: ["mother","green"],
            image: "./pictures/the_great_divide.png", 
            thumb: "./pictures/the_great_divide.png",
            description: [
                          "The Great Divide is a meditation on the birth of digital value amidst generational and ideological conflict. A solemn green matriarch cradles a golden babymarked with the Bitcoin symbol ‚Äî a digital messiah wrapped in swaddling wealth. Around her,the youth sit silently with laptops, bearing the weight of a new world, while protesters and skepticsstand on the opposing cliff, holding blank signs and accusations. Set against a cosmic desert canyon under constellations of coded systems,this painting questions what is inherited, what is mined, and what is rejected. The gold rock at the feet of the critic speaks to the relics of the past; the baby to a future still being written. ü™ê Blockchain as womb. Protest as ritual. Code as constellation. This is not just a divide ‚Äî it is a rebirth. Unlockable Content:Bonus commentary ‚ÄúBirth of the Block‚Äù", 
                            ],
            marketplaces: {
              xrpCafe: "https://xrpcafe.market/‚Ä¶",
              openSea: "https://opensea.io/‚Ä¶",
              superRare: "https://superrare.com/‚Ä¶"
            }
          },
          {
            slug: "The Rusher, The Incrementer, and The Protester",
            title: "The Rusher, The Incrementer, and The Protester",
            year: 2025, style: "Oil-style", motifs: ["bar","archetypes"],
            image: "./pictures/the_rusher_the_incrementer_and_the_protester.png", 
            thumb: "./pictures/the_rusher_the_incrementer_and_the_protester.png",
            description: ["Three men sit at a dimly lit bar ‚Äî a timeless tribunal of modern archetypes: The Rusher, clenched in frustration, his glass half-empty and fists tighter still; The Incrementer, precise and calculating, a monocled figure clad in pinstripes, sipping with a measured grace; and The Protester, puffed-cheeked and clad in a tracksuit, caught mid-reaction, somewhere between rebellion and retreat. Each man drinks from a different vessel ‚Äî a whiskey tumbler, a wine glass, and a crushed beer can ‚Äî reflecting their strategy in the silent war of agency. Crushed sugar cubes and spent lighters scatter the bar, symbols of fuel and burnout. This oil-style portrait isn‚Äôt just a study in temperament ‚Äî it‚Äôs a tension-filled s√©ance of capitalism, identity, and pacing in the digital age. Which one are you?"],
            marketplaces: {
              xrpCafe: "https://xrpcafe.market/‚Ä¶",
              openSea: "https://opensea.io/‚Ä¶",
              superRare: "https://superrare.com/‚Ä¶"
            }
          },
          {
            slug: "Them guys and the older guys",
            title: "Them guys and the older guys",
            year: 2025, style: "Oil-style", motifs: ["saloon", "planning"],
            image: "./pictures/them_guys_and_the_older_guys.png", 
            thumb: "./pictures/them_guys_and_the_older_guys.png",
            description: ["A third work with notes."],
            marketplaces: {
              xrpCafe: "https://xrpcafe.market/‚Ä¶",
              openSea: "https://opensea.io/‚Ä¶",
              superRare: "https://superrare.com/‚Ä¶"
            }
          }
        ]
      }
    ];
  </script>

  <!-- =============== HEADER =============== -->
  <header class="max-w-6xl mx-auto px-4 pt-8">
    <nav class="text-white/70 text-sm">
      <a href="index.html" class="hover:text-white/90">Collections</a>
      <span class="mx-1">‚Ä∫</span>
      <span id="crumbCollection" class="text-white">Loading‚Ä¶</span>
    </nav>

    <div class="mt-6 flex items-start gap-4">
  <img id="collectionImage"
       src="./img/new_collections/Symbols in Motion.png"
       alt="Collection avatar"
       class="h-16 w-16 sm:h-20 sm:w-20 rounded-full object-cover ring-1 ring-white/10 shadow-xl bg-gradient-to-br from-[#0e2e69] to-[#142a66]" />
  <div>
    <h1 id="collectionTitle" class="serif text-2xl sm:text-3xl font-semibold">‚Äî</h1>
    <p id="collectionSubtitle" class="text-white/85 mt-1">‚Äî</p>
    <p id="collectionMeta" class="text-white/70 text-sm mt-1">‚Äî</p>
  </div>
</div>
  </header>

  <!-- =============== BODY =============== -->
  <main class="max-w-6xl mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-12 gap-6">

    <!-- LEFT: artwork + story -->
    <section class="lg:col-span-8">
      <article class="rounded-2xl bg-white/5 backdrop-blur p-5 sm:p-6 shadow-[inset_0_1px_0_0_rgba(255,255,255,0.06)]">
        <!-- Artwork viewer -->
        <h2 id="workTitle" class="serif text-xl sm:text-2xl text-white/95 text-center">‚Äî</h2>

       <figure class="mt-4">
        <div class="relative mx-auto max-w-xl overflow-hidden rounded-2xl bg-black/20 ring-1 ring-white/10 shadow-[0_10px_30px_rgba(0,0,0,0.25)]">
          <img id="workImage"
              src=""
              alt="Artwork"
              class="w-full max-h-[50vh] object-contain mx-auto"
              style="display: block;" />
          <button id="btnPrev" class="absolute inset-y-0 left-0 px-3 text-white/80 hover:text-white focus:outline-none focus:ring-2 focus:ring-white/60" aria-label="Previous artwork">‚Äπ</button>
          <button id="btnNext" class="absolute inset-y-0 right-0 px-3 text-white/80 hover:text-white focus:outline-none focus:ring-2 focus:ring-white/60" aria-label="Next artwork">‚Ä∫</button>
        </div>
        <figcaption id="workMeta" class="text-center text-white/70 text-sm mt-3">‚Äî</figcaption>
      </figure>

      <!-- Artwork Description -->
      <div id="workDescription" class="mt-6 leading-relaxed text-[15px] text-white/90 space-y-4"></div>

        <!-- Collect Art Work Options -->
        <div class="mt-6">
          <p class="text-white/80 mb-3">Collect this Artwork</p>
          <div class="flex items-center gap-4">
            <a id="linkCafe" target="_blank" rel="noopener"
              class="inline-flex h-11 w-11 items-center justify-center rounded-full bg-white/10 ring-1 ring-white/20 hover:bg-white/15"
              aria-label="Collect on XRP Caf√©">
              <img src="./img/round_logos/xrpcafe_circle.png" alt="XRP Caf√©" class="w-full h-full object-cover rounded-full" />
            </a>
            <a id="linkOpenSea" target="_blank" rel="noopener"
              class="inline-flex h-11 w-11 items-center justify-center rounded-full bg-white/10 ring-1 ring-white/20 hover:bg-white/15"
              aria-label="Collect on OpenSea">
              <img src="./img/round_logos/opensea_circle.png" alt="OpenSea" class="w-full h-full object-cover rounded-full" />
            </a>
            <a id="linkSuperRare" target="_blank" rel="noopener"
              class="inline-flex h-11 w-11 items-center justify-center rounded-full bg-white/10 ring-1 ring-white/20 hover:bg-white/15"
              aria-label="Collect on SuperRare">
              <img src="./img/round_logos/superrare_circle.png" alt="SuperRare" class="w-full h-full object-cover rounded-full" />
            </a>
          </div>

        <!-- Mobile strip -->
        <div class="mt-6 lg:hidden">
          <h3 class="serif text-lg mb-3">More in this collection</h3>
          <div id="mobileStrip" class="flex gap-3 overflow-x-auto pb-1 no-scrollbar"></div>
        </div>

        </div>

        <!-- Back (desktop) -->
        <div class="hidden lg:flex mt-5">
          <a href="index.html/#mobile_about" class="inline-flex items-center gap-2 rounded-lg px-3 py-2 ring-1 ring-white/15 hover:bg-white/10">
            <span class="text-lg">‚Äπ</span> Back to Collections
          </a>
        </div>

        <!-- Back (mobile) -->
        <div class="mt-6 lg:hidden">
          <a href="index.html/#mobile_about" class="w-full inline-flex items-center justify-center rounded-lg px-4 py-2 ring-1 ring-white/15 hover:bg-white/10">Back to Collections</a>
        </div>
      </article>
    </section>

    <!-- RIGHT: sidebar grid -->
    <aside class="lg:col-span-4">
      <div class="rounded-2xl bg-white/5 backdrop-blur p-5 sm:p-6 shadow-[inset_0_1px_0_0_rgba(255,255,255,0.06)] hidden lg:block">
        <h3 class="serif text-lg mb-4">All works in this collection</h3>
        <div id="sidebarGrid" class="grid grid-cols-2 gap-4 max-h-[72vh] overflow-auto pr-1"></div>
      </div>
    </aside>
  </main>

  <!-- =============== LOGIC =============== -->
  <script>
    console.log('Script loaded');
    console.log('Collections data:', COLLECTIONS);

    // Test if DOM elements exist
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded');
        console.log('Work image element:', document.querySelector('#workImage'));
        console.log('Work title element:', document.querySelector('#workTitle'));
        
        // Force set the image for testing
        const img = document.querySelector('#workImage');
        if (img) {
            img.src = 'https://via.placeholder.com/400x300';
            console.log('Image src set to:', img.src);
        } else {
            console.log('ERROR: Could not find #workImage element');
        }
    });
    // --- Utilities ---
    const qs = (s,el=document)=>el.querySelector(s);
    const qsa = (s,el=document)=>[...el.querySelectorAll(s)];
    const slugify = s => (s||"").toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
    const bySlug = (list, slug)=> list.find(x => (x.slug || slugify(x.title)) === slug);

    // Read route as /collections/:collection/:work OR #collection/work
    function readRoute() {
      const path = location.pathname.replace(/\/+$/, '');
      const hash = location.hash.replace(/^#/, '');
      // Try pathname first
      const parts = path.split('/').filter(Boolean); // e.g. ["collections","symbols-in-motion","the-rusher"]
      if (parts.length >= 3 && parts[0]==='collections') {
        return { collectionSlug: parts[1], workSlug: parts[2] };
      }
      // Fallback to hash
      if (hash.includes('/')) {
        const [c,w] = hash.split('/');
        return { collectionSlug: c, workSlug: w };
      }
      // Default to first collection/work
      return { collectionSlug: COLLECTIONS[0].slug, workSlug: COLLECTIONS[0].works[0].slug };
    }

    function pushRoute(collectionSlug, workSlug) {
      location.hash = `#${collectionSlug}/${workSlug}`;
    }

    // function pushRoute(collectionSlug, workSlug) {
    //   const path = `/collections/${collectionSlug}/${workSlug}`;
    //   history.replaceState(null, "", path); // feel free to use pushState if you want browser back stack
    // }

    // --- Rendering state ---
    let activeCollection = null;
    let activeIndex = 0;

    function init() {
      const { collectionSlug, workSlug } = readRoute();
      activeCollection = bySlug(COLLECTIONS, collectionSlug) || COLLECTIONS[0];

      // header
      qs('#crumbCollection').textContent = activeCollection.title;
      qs('#collectionTitle').textContent = activeCollection.title;
      qs('#collectionSubtitle').textContent = activeCollection.subtitle || '';
      qs('#collectionMeta').textContent = `${activeCollection.works.length} Works ¬∑ ${activeCollection.startYear} ‚Äì ${activeCollection.endYear}`;

      // pick active index
      const idx = activeCollection.works.findIndex(w => (w.slug||slugify(w.title)) === workSlug);
      activeIndex = idx >= 0 ? idx : 0;

      renderAll();
      wireKeys();
    }

    function renderAll() {
      renderWork();
      renderSidebar();
      renderMobileStrip();
    }

    function renderWork() {
      const w = activeCollection.works[activeIndex];
      const cslug = activeCollection.slug;
      const wslug = w.slug || slugify(w.title);
      pushRoute(cslug, wslug);

      qs('#workTitle').textContent = w.title;
      qs('#workImage').src = w.image;
      qs('#workMeta').textContent = `${w.year} ¬∑ ${w.style}${w.motifs?.length ? ' ¬∑ ' + w.motifs.join(' ‚Ä¢ ') : ''}`;

       // DEBUG: Log what's happening with the image
  console.log('Setting image src to:', w.image);
  const imgElement = qs('#workImage');
  console.log('Image element found:', imgElement);
  imgElement.src = w.image;
  console.log('Image src actually set to:', imgElement.src);
  
  // DEBUG: Test if image loads
  imgElement.onload = () => console.log('‚úÖ Image loaded successfully');
  imgElement.onerror = () => console.log('‚ùå Image failed to load');
  
  // qs('#workMeta').textContent = `${w.year} ¬∑ ${w.style}${w.motifs?.length ? ' ¬∑ ' + w.motifs.join(' ‚Ä¢ ') : ''}`;
  

      // description
      const descEl = qs('#workDescription');
      descEl.innerHTML = "";
      (w.description || []).forEach(p => {
        const el = document.createElement('p');
        el.textContent = p;
        descEl.appendChild(el);
      });

      // marketplace links (hide if missing)
      const setLink = (id, url) => {
        const a = qs(id);
        if (url) { a.href = url; a.classList.remove('opacity-40','pointer-events-none'); }
        else { a.href = '#'; a.classList.add('opacity-40','pointer-events-none'); }
      };
      setLink('#linkCafe', w.marketplaces?.xrpCafe);
      setLink('#linkOpenSea', w.marketplaces?.openSea);
      setLink('#linkSuperRare', w.marketplaces?.superRare);

      // prev/next
      qs('#btnPrev').onclick = () => { activeIndex = (activeIndex-1+activeCollection.works.length)%activeCollection.works.length; renderAll(); };
      qs('#btnNext').onclick = () => { activeIndex = (activeIndex+1)%activeCollection.works.length; renderAll(); };

      // active highlight in sidebar/strip
      highlightActive();
      // Optional: preload neighbors
      preloadNeighbors();
      // Scroll to top of page on change (nice on mobile)
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function renderSidebar() {
      const grid = qs('#sidebarGrid');
      grid.innerHTML = "";
      activeCollection.works.forEach((w,i) => {
        const wslug = w.slug || slugify(w.title);
        const card = document.createElement('button');
        card.className = "group text-left";
        card.setAttribute('aria-label', `View ${w.title}`);
        card.innerHTML = `
          <div class="aspect-square rounded-xl overflow-hidden ring-1 ring-white/15 shadow hover:shadow-lg transition ${i===activeIndex?'ring-2 ring-white/60':''}">
            <img src="${w.thumb}" alt="" class="w-full h-full object-cover group-hover:scale-[1.02] transition">
          </div>
          <div class="mt-2">
            <p class="text-sm text-white/95">${w.title}</p>
            <p class="text-xs text-white/60">${w.year} ¬∑ ${w.style}${w.motifs?.length ? ' ¬∑ ' + w.motifs[0] : ''}</p>
          </div>
        `;
        card.onclick = () => { activeIndex = i; renderAll(); };
        grid.appendChild(card);
      });
    }

    function renderMobileStrip() {
      const strip = qs('#mobileStrip');
      strip.innerHTML = "";
      activeCollection.works.forEach((w,i) => {
        const b = document.createElement('button');
        b.className = "shrink-0 w-28";
        b.setAttribute('aria-label', `View ${w.title}`);
        b.innerHTML = `
          <div class="aspect-square rounded-xl overflow-hidden ring-1 ${i===activeIndex?'ring-white/60':'ring-white/15'}">
            <img src="${w.thumb}" alt="" class="w-full h-full object-cover">
          </div>
          <p class="mt-2 text-xs ${i===activeIndex?'text-white':'text-white/80'} line-clamp-2">${w.title}</p>
        `;
        b.onclick = () => { activeIndex = i; renderAll(); };
        strip.appendChild(b);
      });
    }

    function highlightActive() {
      // Sidebar and strip already re-render with active styles; this is here if you later switch to partial updates.
    }

    function preloadNeighbors() {
      const urls = [];
      const wPrev = activeCollection.works[(activeIndex-1+activeCollection.works.length)%activeCollection.works.length];
      const wNext = activeCollection.works[(activeIndex+1)%activeCollection.works.length];
      if (wPrev?.image) urls.push(wPrev.image);
      if (wNext?.image) urls.push(wNext.image);
      urls.forEach(u => { const img = new Image(); img.src = u; });
    }

    function wireKeys() {
      window.addEventListener('keydown', (e) => {
        if (['INPUT','TEXTAREA','SELECT'].includes((e.target||{}).tagName)) return;
        if (e.key === 'ArrowLeft') { e.preventDefault(); qs('#btnPrev').click(); }
        if (e.key === 'ArrowRight') { e.preventDefault(); qs('#btnNext').click(); }
      });
      window.addEventListener('popstate', () => {
        // If user navigates via back/forward, re-read route
        const { collectionSlug, workSlug } = readRoute();
        if (activeCollection.slug !== collectionSlug) {
          activeCollection = bySlug(COLLECTIONS, collectionSlug) || COLLECTIONS[0];
        }
        const idx = activeCollection.works.findIndex(w => (w.slug||slugify(w.title)) === workSlug);
        activeIndex = idx >= 0 ? idx : 0;
        renderAll();
      });
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
